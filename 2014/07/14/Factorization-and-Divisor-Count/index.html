<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Factorization and Divisor Count | apnorton | blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="How many divisors are there of the number $1281942112$?  It turns out that determining the answer to this problem is (at most) only as difficult as determining the prime factorization of the number.">
<meta property="og:type" content="article">
<meta property="og:title" content="Factorization and Divisor Count">
<meta property="og:url" content="http://www.apnorton.com/blog/2014/07/14/Factorization-and-Divisor-Count/index.html">
<meta property="og:site_name" content="apnorton | blog">
<meta property="og:description" content="How many divisors are there of the number $1281942112$?  It turns out that determining the answer to this problem is (at most) only as difficult as determining the prime factorization of the number.">
<meta property="og:updated_time" content="2016-12-19T22:55:04.614Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Factorization and Divisor Count">
<meta name="twitter:description" content="How many divisors are there of the number $1281942112$?  It turns out that determining the answer to this problem is (at most) only as difficult as determining the prime factorization of the number.">
<meta name="twitter:creator" content="@_apnorton">
  
    <link rel="alternative" href="/blog/atom.xml" title="apnorton | blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/blog/css/style.css">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-63901553-2', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


</head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/blog/" id="logo">apnorton | blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/blog/">Blog</a>
        
          <a class="main-nav-link" href="http://www.apnorton.com/">Web Home</a>
        
          <a class="main-nav-link" href="/blog/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/blog/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://www.apnorton.com/blog"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-Factorization-and-Divisor-Count" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2014/07/14/Factorization-and-Divisor-Count/" class="article-date">
  <time datetime="2014-07-14T15:59:15.000Z" itemprop="datePublished">2014-07-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/blog/categories/math/">math</a>►<a class="article-category-link" href="/blog/categories/math/number-theory/">number-theory</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Factorization and Divisor Count
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>How many divisors are there of the number $1281942112$?  It turns out that determining the answer to this problem is (at most) only as difficult as determining the prime factorization of the number.  In this blog post, I will outline a solution to this (and similar) problems.</p>
<h2 id="The-Math"><a href="#The-Math" class="headerlink" title="The Math"></a>The Math</h2><p>The <a href="http://mathworld.wolfram.com/FundamentalTheoremofArithmetic.html" target="_blank" rel="external">Fundamental Theorem of Arithmetic</a> guarantees each positive integer greater than $1$ a unique prime factorization.  We write this factorization as:</p>
<p>$$N = p_0^{e_0}p_1^{e_1}\cdots p_n^{e_n}$$</p>
<p>where $p_k$ is a prime number, and $e_k$ is its corresponding exponent.  This provides us with useful information regarding divisors of $N$: any divisor of $N$ must be comprised of some combination of those prime factors (and exponents).  Specifically, we can define the divisor, $D$, as:</p>
<p>$$D = p_0^{a_0}p_1^{a_1}\cdots p_n^{a_n}$$</p>
<p>where the $p_k$ are the same as in the factorization of $N$ and $a_k \in {0, 1, \ldots, e_k}$.  To find the total number of divisors, we multiply together the number of options we have for each exponent.  That is,</p>
<p>$$\text{Number of Divisors}\; = (e_0+1)(e_1+1)\cdots(e_n + 1)$$</p>
<p>Example:  Consider $N = 20$.  In this case, $N$ has $6$ divisors; to determine this without needing to list them all, we may note that $N = 2^2\cdot 5^1$.  Using the notation described above, this means that $p_0 = 2,\;p_1 = 5$ and $e_0 = 2\;e_1 = 1$.  Each of our divisors will be of the form $2^{a_0}\cdot 5^{a_1}$, where $a_0$ could be $0, 1,$ or $2$ and $a_1$ could be $0$ or $1$.  Since we have $e_0+1 = 3$ options for $a_0$ and $e_1+1 = 2$ options for $a_1$, we have $3\cdot 2 = 6$ total divisors.  In case you were wondering, the list of divisors is:</p>
<p>$${2^0 5^0, 2^1 5^0,2^2 5^0,2^0 5^1,2^1 5^1,2^2 5^1}$$</p>
<a id="more"></a>
<h2 id="The-Program"><a href="#The-Program" class="headerlink" title="The Program"></a>The Program</h2><p>We’re not out of the woods yet–we have a formula, but we need to write a program to make use of it.  The first thing our program needs is a list of primes.  I’m going to assume you have a function already that can generate a list of primes.  A prime-listing function is an important tool in any programmer’s toolkit, but I’ll save that for a future post.</p>
<p>The pseudocode for our program is below:</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">numberOfDivisors: int <span class="keyword">N</span> -&gt; int divisorCount</span><br><span class="line">  divisorCount = 1</span><br><span class="line">  <span class="keyword">for</span> (p = 1 to <span class="built_in">floor</span>(<span class="built_in">sqrt</span>(<span class="keyword">N</span>)) &amp;&amp; p prime):</span><br><span class="line">    exponent = 0 </span><br><span class="line"></span><br><span class="line">    <span class="comment">//Determine exponent of p in prime factorization</span></span><br><span class="line">    <span class="keyword">while</span> (p divides <span class="keyword">N</span>):</span><br><span class="line">      exponent++</span><br><span class="line">      <span class="keyword">N</span> = <span class="keyword">N</span> / p</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">     <span class="comment">//Update divisorCount</span></span><br><span class="line">     divisorCount = divisorCount * (exponent + 1)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//In this case, there is one prime factor greater than the square root of N</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">N</span> != 1) divisorCount = divisorCount * 2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> divisorCount</span><br></pre></td></tr></table></figure>
<p>This is mostly straightforward: We iterate through all prime numbers less than the square root of N.  For each prime, we determine how many times it divides N–this is that prime’s exponent.  We then multiply the current divisor count by one more than the exponent.  I have pushed an update to my <a href="https://github.com/apnorton/math" target="_blank" rel="external">math GitHub repository</a> that includes a Java version of this algorithm in NumberTheory.java.</p>
<p>If we kept track of which primes divide $N$ (for example, adding them to a List whenever we enter the while loop) this program is easily modified to output the prime factorization of a number.</p>
<h2 id="The-Analysis"><a href="#The-Analysis" class="headerlink" title="The Analysis"></a>The Analysis</h2><p>Before analyzing the performance of the algorithm, it would be best to explain why we only need to use primes less than $\sqrt{N}$, not primes less than $N$.  This is because <strong>there can only be one prime factor of $N$ greater than $\sqrt{N}$, and (if there is one) it must have only be raised to the $1$st power.</strong>  A proof by contradiction works well here (I’m skipping some rigor, please don’t kill me):</p>
<blockquote>
<p>Assume that there are two prime factors (not necessarily unique) $p$ and $q$ of $N$, such that $p,q \gt \sqrt{N}$.  Let the product of the remaining prime factors be some integer $m$.  Then we have:</p>
<p>   $$\begin{align}<br>       N &amp;= p\cdot q\cdot m \<br>         &amp;\le p\cdot q \<br>         &amp;\lt \sqrt{N}\sqrt{N}\<br>         &amp;\lt N\end{align}$$</p>
<p>This is clearly a contradiction, thus we have proven that there cannot be at least two prime factors of $N$ greater than $\sqrt{N}$.  Equivalently, there may only at most one prime factor of $N$ greater than $\sqrt{N}$.</p>
</blockquote>
<p>This explains why we don’t need to use primes greater than $\sqrt{N}$: if, after “dividing out” all primes less than $\sqrt{N}$, we are left with a number, then that number must be the single prime factor of $N$ greater than $\sqrt{N}$.</p>
<p>On to the performance of the algorithm.  Assuming we are <em>given</em> a list of prime numbers (and don’t have to compute them), this procedure has a time complexity of $\mathcal{O}\left(\pi\left(\sqrt{N}\right)\text{lg}(N)\right)$ and $\Omega\left(\pi\left(\sqrt{N}\right)\right)$, where $\pi(x)$ is the <a href="http://mathworld.wolfram.com/PrimeCountingFunction.html" target="_blank" rel="external">prime counting function</a> and $N$ is the input number.  ($\Omega$ provides a lower bound, and $\mathcal{O}$ provides an upper bound.)  Let’s see why.</p>
<p>We have an outer-most for loop that makes one iteration for each prime less than $\sqrt{N}$.  This gives us the “$\pi\left(\sqrt{N}\right)$” part of the bounds.  For the lower bound, we would assume the inside of the for loop executes in constant time, every time.  (That is, we never enter the while loop.)  This occurs when $N$ is a prime number.  For the upper bound, we may assume that we execute the while loop at most $\text{lg}(N)$ times each iteration.  This is because $\text{lg}(N) = \log_2(N) \gt \log_b(N)$ for $N \gt 2$ and integer $b\gt 2$, and $\lfloor\log_{p_k}(N)\rfloor$ provides a fairly close upper bound on the exponent of $p_k$ in the prime factorization of $N$.</p>
<p>The upper bound can be improved by performing some summation and simplification, but it’s close enough to show how fast this algorithm is.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.apnorton.com/blog/blog/2014/07/14/Factorization-and-Divisor-Count/" data-id="cixjei6dq000h23gc2v3wmrm4" class="article-share-link">Share</a>
      
        <a href="http://www.apnorton.com/blog/blog/2014/07/14/Factorization-and-Divisor-Count/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/algorithms/">algorithms</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/math/">math</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/number-theory/">number-theory</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/project-euler/">project-euler</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/blog/2014/07/14/How-to-Learn-Haskell/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          How to Learn Haskell
        
      </div>
    </a>
  
  
    <a href="/blog/2014/06/09/Big-O-notation-An-Introduction-to-Asymptotics-of-Loops/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">&quot;Big-O&quot; notation: An Introduction to Asymptotics of Loops</div>
    </a>
  
</nav>

  
</article>


<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/blog/2017/01/04/Machine-Learning-with-the-Surface-Book/">Machine Learning with the Surface Book</a>
          </li>
        
          <li>
            <a href="/blog/2016/12/19/Visualizing-Multidimensional-Data-in-Python/">Visualizing Multidimensional Data in Python</a>
          </li>
        
          <li>
            <a href="/blog/2016/11/09/Election-2016/">Election 2016: Moving Forward</a>
          </li>
        
          <li>
            <a href="/blog/2016/10/28/Commenting/">New Feature: Commenting!</a>
          </li>
        
          <li>
            <a href="/blog/2016/09/30/A-Summer-with-Microsoft/">A Microsoft Summer, Part 1: Seattle Fun</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/blog/categories/book-reviews/">book-reviews</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/computer-science/">computer-science</a><span class="category-list-count">6</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/blog/categories/computer-science/algorithms/">algorithms</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/computer-science/contests/">contests</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/computer-science/programming-languages/">programming-languages</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/computer-science/tools/">tools</a><span class="category-list-count">3</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/fun/">fun</a><span class="category-list-count">2</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/blog/categories/fun/seattle/">seattle</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/math/">math</a><span class="category-list-count">2</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/blog/categories/math/computational-geometry/">computational-geometry</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/math/number-theory/">number-theory</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/meta/">meta</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/opinion/">opinion</a><span class="category-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/blog/tags/algorithms/" style="font-size: 15px;">algorithms</a> <a href="/blog/tags/books/" style="font-size: 12.5px;">books</a> <a href="/blog/tags/computer-science/" style="font-size: 17.5px;">computer-science</a> <a href="/blog/tags/contests/" style="font-size: 10px;">contests</a> <a href="/blog/tags/data/" style="font-size: 12.5px;">data</a> <a href="/blog/tags/functional-programming/" style="font-size: 10px;">functional-programming</a> <a href="/blog/tags/general-computing/" style="font-size: 10px;">general-computing</a> <a href="/blog/tags/internship/" style="font-size: 12.5px;">internship</a> <a href="/blog/tags/life/" style="font-size: 12.5px;">life</a> <a href="/blog/tags/math/" style="font-size: 20px;">math</a> <a href="/blog/tags/meta/" style="font-size: 12.5px;">meta</a> <a href="/blog/tags/number-theory/" style="font-size: 10px;">number-theory</a> <a href="/blog/tags/opinion/" style="font-size: 10px;">opinion</a> <a href="/blog/tags/project-euler/" style="font-size: 10px;">project-euler</a> <a href="/blog/tags/websites/" style="font-size: 10px;">websites</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2017/01/">January 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2016/12/">December 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2016/11/">November 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2016/10/">October 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2016/09/">September 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2016/08/">August 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2016/03/">March 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2015/10/">October 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2015/06/">June 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2014/07/">July 2014</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2014/06/">June 2014</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2014/05/">May 2014</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 Andrew Norton<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/blog/" class="mobile-nav-link">Blog</a>
  
    <a href="http://www.apnorton.com/" class="mobile-nav-link">Web Home</a>
  
    <a href="/blog/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    
<script>
  var disqus_shortname = 'apnorton';
  
  var disqus_url = 'http://www.apnorton.com/blog/blog/2014/07/14/Factorization-and-Divisor-Count/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/blog/fancybox/jquery.fancybox.css">
  <script src="/blog/fancybox/jquery.fancybox.pack.js"></script>


<script src="/blog/js/script.js"></script>

  </div>

<!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
</body>
</html>